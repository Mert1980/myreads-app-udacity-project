<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/Search.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/Search.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React from "react";
import { Link } from "react-router-dom";
import { search } from "../BooksAPI";
import Book from "./Book";
import { debounce } from "debounce";
import PropTypes from "prop-types";

/**
 * Component that renders books when user queries in the search box
 *
 * @component
 */
class Search extends React.Component {
  state = {
    query: "",
    books: [],
  };

  /**
   * Debounce takes a function as a parameter and delays the execution
   * of it for a predefined time. Since setState works asynchronously,
   * we delay the searchQuery function for 2ms until the state of the query
   * is changed by the state.
   *
   * @function searchQuery
   *
   * @param {function} callback function - searchQuery function to fetch books iaw query
   *
   */
  searchQuery = debounce(function(query, cb) {
    search(query).then((result) => cb(result));
  }, 200);

  /**
   * Update the state of the query in accordance with the user input
   * Search books in API by typing in search field
   *
   * @function updateQuery
   *
   * @param input event
   * 
   * @returns new state of books
   */
  updateQuery = (event) => {
    const query = event.target.value;
    this.setState({ query });

    if (query.length === 0) {
      this.setState({ books: [] });
    } else if (query.trim()) {
      this.searchQuery(query.trim(), (response) => {
        if (response.error) {
          this.setState({ books: [] });
        } else {
          this.setState({ books: response });
        }
      });
    }
  };

  render() {
    const { query } = this.state;
    return (
      &lt;div>
        &lt;div className="search-books">
          &lt;div className="search-books-bar">
            &lt;Link to="/">
              &lt;button className="close-search">Close&lt;/button>
            &lt;/Link>
            &lt;div className="search-books-input-wrapper">
              &lt;input
                type="text"
                placeholder="Search by title or author"
                value={query}
                onChange={this.updateQuery}
              />
            &lt;/div>
          &lt;/div>
          &lt;div className="search-books-results">
            &lt;ol className="books-grid">
              {this.state.books.length > 0 &amp;&amp;
                this.state.books.map((book) => {
                  return (
                    &lt;li key={book.id}>
                      &lt;Book
                        book={book}
                        title={book.title}
                        authors={book.authors}
                        image={book.imageLinks ? book.imageLinks.thumbnail : ""}
                        getAllBooks={this.props.getAllBooks}
                      />
                    &lt;/li>
                  );
                })}
            &lt;/ol>
          &lt;/div>
        &lt;/div>
      &lt;/div>
    );
  }
}

Search.propTypes = {
  /**
   * book object
   */
  book: PropTypes.object,
  /**
   * Book's title
   */
  title: PropTypes.string,
  /**
   * Book's authors
   */
  authors: PropTypes.array,
  /**
   * Book's cover image link
   */
  image: PropTypes.string,
  /**
   * Function to fetch all books from API
   */
  getAllBooks: PropTypes.func,
};

export default Search;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Book.html">Book</a></li><li><a href="BooksApp.html">BooksApp</a></li><li><a href="BookShelf.html">BookShelf</a></li><li><a href="Search.html">Search</a></li></ul><h3>Global</h3><ul><li><a href="global.html#getAllBooks">getAllBooks</a></li><li><a href="global.html#handleSelectShelf">handleSelectShelf</a></li><li><a href="global.html#searchQuery">searchQuery</a></li><li><a href="global.html#setShelf">setShelf</a></li><li><a href="global.html#updateQuery">updateQuery</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Sat May 30 2020 14:59:37 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
